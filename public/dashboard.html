<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VolunteerHub Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .container {
            width: 75vw;
            height: 75vh;
            position: relative;
            margin: auto;
            border: 2px solid gray;
            background-color: rgba(200, 200, 200, 0.2);
        }

        .widget {
            width: 25vw;
            height: 25vh;
            background: rgba(0, 0, 0, 0.7); /* Increase transparency */
            color: white; /* Ensure text is visible on dark background */
            text-align: center;
            font-size: 1.2rem;
            position: absolute;
            border-radius: 10px;
            cursor: grab;
            resize: none;
            overflow: auto;
            min-width: 180px;
            min-height: 120px;
            max-width: 100%;
            max-height: 100%;
        }

        .editing .widget {
            cursor: move;
            resize: both;
        }

        .editing .widget.corner-indicator {
            position: relative;
        }
.editing .widget::after,
.editing .widget::before,
.editing .widget .corner-br {
    position: absolute;
    pointer-events: none;
    z-index: 10;
    background: none;
    display: none;
}
.editing .widget .corner-br { right: 0; bottom: 0; display: block; }

.editing .widget .corner-br::before,
.editing .widget .corner-br::after {
    content: '';
    position: absolute;
    background: white;
}
.editing .widget .corner-br::before {
    right: 0; bottom: 0;
    width: 26px; height: 7px;
    border-bottom-right-radius: 24px 24px;
}
.editing .widget .corner-br::after {
    right: 0; bottom: 0;
    width: 7px; height: 26px;
    border-bottom-right-radius: 24px 24px;
}

        #widget1 {
            top: 0;
            left: 0;
        }

        #widget2 {
            top: 0;
            right: 0;
        }

        #widget3 {
            bottom: 0;
            left: 0;
        }

        #widget4 {
            bottom: 0;
            right: 0;
        }

        #backgroundVideo {
            position: fixed;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -1;
        }

        header {
            background-color: rgba(255, 255, 255, 0.75); /* 75% transparency */
        }

        aside {
            background-color: rgba(255, 255, 255, 0.75); /* 75% transparency */
        }
        .prevent-select {
        -webkit-user-select: none; /* Safari */
        -ms-user-select: none; /* IE 10 and IE 11 */
        user-select: none; /* Standard syntax */
        }
        .widget, .widget * {
  user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
}
    </style>
</head>
<body class="bg-gray-100 flex flex-col h-screen">
    <!-- Background Video -->
    <video autoplay muted loop id="backgroundVideo" class="prevent-select">
        <source src="https://cdn.pixabay.com/video/2023/02/16/150883-799711528_large.mp4" type="video/mp4">
    </video>

    <!-- Header -->
    <header class="flex items-center justify-between bg-white shadow-md px-6 py-4 fixed top-0 left-0 w-full z-50">
        <h1 class="text-xl font-bold text-gray-700">VolunteerHub</h1>
        <div class="relative flex items-center gap-4">
            <!-- Profile -->
            <img src="https://via.placeholder.com/40" alt="Profile" class="w-10 h-10 rounded-full border border-gray-300 cursor-pointer" onclick="toggleMenu()">
            <div id="profileMenu" class="hidden absolute top-16 right-0 w-44 shadow-lg rounded-md z-50 border transition-colors">
                <ul class="py-2 text-sm" id="profileMenuList">
                    <li><a href="#" class="block px-4 py-2">Profile</a></li>
                    <li><button class="w-full text-left block px-4 py-2 text-red-600">Log Out</button></li>
                </ul>
            </div>
        </div>
    </header>

    <!-- Layout Wrapper -->
    <div class="flex flex-1">
        <!-- Sidebar -->
        <aside class="w-64 h-[100vh] bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-200 shadow-md flex flex-col justify-between fixed pt-24">
            <nav class="mt-6 flex-1">
                <ul class="space-y-2">
                    <li><a href="#" class="block px-6 py-3 text-gray-700 hover:bg-gray-200">Activities</a></li>
                    <li><a href="#" class="block px-6 py-3 text-gray-700 hover:bg-gray-200">Leaderboard</a></li>
                    <li><a href="#" class="block px-6 py-3 text-gray-700 hover:bg-gray-200">My Hours</a></li>
                </ul>
            </nav>

            <div class="flex items-center justify-center gap-4 mb-4 px-6">
                <button id="sidebarSettingsBtn" class="w-10 h-10 text-gray-600 hover:text-gray-800" style="padding-bottom: 10px;">
                     <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" class="themed-icon"><path d="m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"/></svg>
                </button>
                <button id="sidebarPrintBtn" class="w-10 h-10 text-gray-600 hover:text-gray-800" style="padding-bottom: 10px;">
                     <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 0 24 24" width="24px" class="themed-icon"><path d="M640-640v-120H320v120h-80v-200h480v200h-80Zm-480 80h640-640Zm560 100q17 0 28.5-11.5T760-500q0-17-11.5-28.5T720-540q-17 0-28.5 11.5T680-500q0 17 11.5 28.5T720-460Zm-80 260v-160H320v160h320Zm80 80H240v-160H80v-240q0-51 35-85.5t85-34.5h560q51 0 85.5 34.5T880-520v240H720v160Zm80-240v-160q0-17-11.5-28.5T760-560H200q-17 0-28.5 11.5T160-520v160h80v-80h480v80h80Z"/></svg>
                </button>
            </div>
        </aside>
        

        <!-- Main Content with Movable Widgets -->
        <main class="flex-1 p-6 ml-64 relative mt-[64px]">
            <!-- Greeting Container -->
            <div class="bg-black bg-opacity-50 text-white p-6 rounded-md shadow-md relative">
                <button id="editButton" class="absolute top-4 right-4 p-2 rounded-full transition-colors" title="Edit Widgets" style="background: var(--accent, #2563eb);">
                  <svg id="editIcon" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h357l-80 80H200v560h560v-278l80-80v358q0 33-23.5 56.5T760-120H200Zm280-360ZM360-360v-170l367-367q12-12 27-18t30-6q16 0 30.5 6t26.5 18l56 57q11 12 17 26.5t6 29.5q0 15-5.5 29.5T897-728L530-360H360Zm481-424-56-56 56 56ZM440-440h56l232-232-28-28-29-28-231 231v57Zm260-260-29-28 29 28 28 28-28-28Z"/></svg>
                </button>
                <h1 id="greeting" class="text-3xl font-bold"></h1>
                <p id="currentDate" class="text-lg mt-2"></p>
            </div>

            <!-- Movable Widgets -->
        <!-- Movable Container -->
        <div class="container" id="container">
            <!-- Movable Widgets -->
            <div class="widget bg-black bg-opacity-25 text-white flex flex-col items-center justify-center select-none" id="widget1" style="user-select: none;">
  <div class="corner-br"></div>
  <div class="text-lg font-semibold mb-1">Approved Hours</div>
  <div id="approvedHours" class="text-3xl font-bold">0</div>
  <div class="text-sm mt-1">Signed Activities</div>
  <div id="approvedActivities" class="text-xl font-semibold">0</div>
</div>
            <div class="widget bg-black bg-opacity-25 text-white flex flex-col items-center justify-center select-none" id="widget2" style="user-select: none;">
  <div class="corner-br"></div>
  <div class="text-lg font-semibold mb-1">Unapproved Hours</div>
  <div id="unapprovedHours" class="text-3xl font-bold">0</div>
  <div class="text-sm mt-1">Unapproved Activities</div>
  <div id="unapprovedActivities" class="text-xl font-semibold">0</div>
</div>
            <div class="widget bg-black bg-opacity-25 text-white" id="widget3">
  <div class="corner-br"></div>
  Widget 3
</div>
            <div class="widget bg-black bg-opacity-25 text-white" id="widget4">
  <div class="corner-br"></div>
  Widget 4
</div>
        </div>

        <!-- Activities Section -->
        <section id="activitiesSection" class="mt-12 bg-white bg-opacity-80 rounded-md shadow-md p-6">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-2xl font-bold text-gray-800">Activities</h2>
                <button id="addActivityBtn" class="px-4 py-2 bg-blue-600 text-white rounded-md">Add Activity</button>
            </div>
            <!-- Modal for Add Activity Form -->
            <div id="activityModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden">
        <div class="bg-white rounded-lg shadow-lg p-6 relative w-full max-w-lg">
            <button id="closeActivityModal" class="absolute top-2 right-2 text-gray-500 hover:text-gray-800 text-2xl font-bold">&times;</button>
            <form id="addActivityForm" class="space-y-4 mb-4">
                <div class="flex flex-wrap gap-4">
                    <input type="text" id="activityTitle" placeholder="Title" class="border rounded px-3 py-2 flex-1" required>
                    <input type="text" id="activityPlace" placeholder="Place" class="border rounded px-3 py-2 flex-1" required>
                </div>
                <div class="flex flex-wrap gap-4">
                    <input type="date" id="activityDate" class="border rounded px-3 py-2 flex-1" required>
                    <input type="time" id="activityStartTime" class="border rounded px-3 py-2 flex-1" required>
                    <input type="time" id="activityEndTime" class="border rounded px-3 py-2 flex-1" required>
                </div>
                <div class="flex flex-wrap gap-4">
                    <input type="text" id="supervisorName" placeholder="Supervisor Name" class="border rounded px-3 py-2 flex-1" required>
                    <input type="email" id="supervisorEmail" placeholder="Supervisor Email" class="border rounded px-3 py-2 flex-1" required>
                </div>
                <div class="flex items-center mb-2">
                    <input type="checkbox" id="getSignatureCheckbox" class="mr-2">
                    <label for="getSignatureCheckbox" class="text-gray-700">Get a Signature (email supervisor)</label>
                </div>
                <div class="flex gap-4">
                    <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded">Submit</button>
                    <button type="button" id="cancelAddActivity" class="px-4 py-2 bg-gray-400 text-white rounded">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    <div id="activityStatus" class="mb-4"></div>
    <div id="activitiesList"></div>
    <button id="printActivitiesBtn" style="margin:20px 0; display:none;" class="px-4 py-2 bg-purple-600 text-white rounded-md">Print Activities PDF</button>
</section>
<!-- End Activities Section -->

        <!-- Leaderboard Section -->
        <section id="leaderboardSection" class="mt-12 bg-white bg-opacity-80 rounded-md shadow-md p-6">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-2xl font-bold text-gray-800">Leaderboard</h2>
                <div class="flex gap-2">
                    <button id="globalLeaderboardBtn" class="px-3 py-1 bg-blue-600 text-white rounded-md">Global</button>
                    <button id="friendsLeaderboardBtn" class="px-3 py-1 bg-gray-400 text-white rounded-md">Friends</button>
                    <button id="localLeaderboardBtn" class="px-3 py-1 bg-gray-400 text-white rounded-md">Local</button>
                </div>
            </div>
            <div id="leaderboardStatus" class="mb-4"></div>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead>
                        <tr>
                            <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rank</th>
                            <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Volunteer</th>
                            <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Approved Hours</th>
                            <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Unapproved Hours</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboardBody" class="bg-white divide-y divide-gray-200">
                        <tr><td colspan="4" class="text-center text-gray-400 py-4">Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </section>
        <!-- End Leaderboard Section -->
        </main>
    </div>

    <script src="/public/dashboard-core.js"></script>
    <script src="/public/dashboard-theme.js"></script>
    <script src="/public/dashboard-activities.js"></script>
    <script src="/public/dashboard-leaderboard.js"></script>
    <script src="/public/dashboard-ui.js"></script>
    <script type="module" src="/public/app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script>
// Apply theme color to all .themed-icon SVGs
function applyThemedIcons(color) {
  document.querySelectorAll('.themed-icon').forEach(svg => {
    svg.style.color = color;
    svg.setAttribute('fill', color);
    svg.querySelectorAll('path').forEach(path => path.setAttribute('fill', color));
  });
}
// Listen for theme changes (dashboard-theme.js should call this after applying theme)
window.applyThemedIcons = applyThemedIcons;
</script>
</body>
</html>
