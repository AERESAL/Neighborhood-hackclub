<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VolunteerHub Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --accent: #2563eb; /* Default accent, will be overridden by JS theme logic */
            --color2: #22d3ee; /* Default color2, will be overridden by JS theme logic */
        }
        button, .btn, .accent-btn {
            background: var(--accent, #2563eb);
            color: #fff;
            border: none;
            transition: background 0.2s, color 0.2s;
        }
        button:hover, .btn:hover, .accent-btn:hover {
            background: #1e40af;
            color: #fff;
        }
        /* For outlined accent buttons */
        .btn-outline, .accent-btn-outline {
            background: transparent;
            color: var(--accent, #2563eb);
            border: 2px solid var(--accent, #2563eb);
        }
        .btn-outline:hover, .accent-btn-outline:hover {
            background: var(--accent, #2563eb);
            color: #fff;
        }

        .container {
            width: 75vw;
            height: 75vh;
            position: relative;
            margin: auto;
            background-color: rgba(0,0,0,0.05); /* 5% opacity black background for subtle separation */
            backdrop-filter: blur(.5px); /* Add blur for glassy look */
            -webkit-backdrop-filter: blur(.5px); /* Safari support */
            border: none;
            overflow: visible;
        }

        .widget {
            width: 25vw;
            height: 25vh;
            background: rgba(0, 0, 0, 0.5); /* Increased transparency (more opacity) */
            color: white; /* Ensure text is visible on dark background */
            text-align: center;
            font-size: 1.2rem;
            position: absolute;
            border-radius: 10px;
            cursor: grab;
            resize: none;
            overflow: auto;
            min-width: 180px;
            min-height: 180px;
            max-width: calc(100vw - 8rem); /* Prevents widget from going off the right edge */
            max-height: calc(100vh - 10rem); /* Prevents widget from going off the bottom edge */
            box-sizing: border-box;
        }

        .container > .widget {
            background: rgba(0, 0, 0, 0.35); /* Even more transparent for widgets in container */
        }

        .editing .widget {
            cursor: move;
            resize: both;
        }

        .editing .widget.corner-indicator {
            position: relative;
        }
.editing .widget::after,
.editing .widget::before,
.editing .widget .corner-br {
    position: absolute;
    pointer-events: none;
    z-index: 10;
    background: none;
    display: none;
}
.editing .widget .corner-br { right: 0; bottom: 0; display: block; }

.editing .widget .corner-br::before,
.editing .widget .corner-br::after {
    content: '';
    position: absolute;
    background: white;
}
.editing .widget .corner-br::before {
    right: 0; bottom: 0;
    width: 26px; height: 7px;
    border-bottom-right-radius: 24px 24px;
}
.editing .widget .corner-br::after {
    right: 0; bottom: 0;
    width: 7px; height: 26px;
    border-bottom-right-radius: 24px 24px;
}

        #widget1 {
            top: 0;
            left: 0;
        }

        #widget2 {
            top: 0;
            right: 0;
        }

        #widget3 {
            bottom: 0;
            left: 0;
        }

        #widget4 {
            bottom: 0;
            right: 0;
        }

        #backgroundVideo {
            position: fixed;
            width: 100%;
            height: 100%;
            object-fit: cover;
            z-index: -1;
        }

        header {
            background-color: rgba(255, 255, 255, 0.75); /* 75% transparency */
        }

        aside {
            background-color: rgba(255, 255, 255, 0.75); /* 75% transparency */
        }
        .prevent-select {
        -webkit-user-select: none; /* Safari */
        -ms-user-select: none; /* IE 10 and IE 11 */
        user-select: none; /* Standard syntax */
        }
        .widget, .widget * {
  user-select: none;
  -webkit-user-select: none;
  -ms-user-select: none;
}
.greeting-container, main > div.bg-black {
            background: rgba(0, 0, 0, 0.6); /* Remove !important so JS can override */
            backdrop-filter: blur(12px);
        }
        /* Sidebar themed icons use color2 */
        aside .themed-icon {
            color: var(--color2, #22d3ee);
            z-index: 2;
            position: relative;
            width: 32px;
            height: 32px;
            min-width: 32px;
            min-height: 32px;
            max-width: 40px;
            max-height: 40px;
            display: inline-block;
            vertical-align: middle;
            opacity: 1;
            visibility: visible;
            border-radius: 50%;
            background: rgba(0,0,0,0.08); /* Subtle background for icon contrast */
            box-shadow: 0 2px 8px 0 rgba(0,0,0,0.07);
        }
        /* Remove fill/stroke from path/use, let SVG inherit color via currentColor */
        /* Remove fallback !important sizing unless needed for layout */
        /* Remove JS that forcibly sets fill/stroke/color on SVGs */
        #sidebarSettingsBtn, #sidebarPrintBtn {
            color: inherit;
            background: transparent;
            z-index: 2;
            position: relative;
        }
        /* Print: force landscape orientation */
        @media print {
            @page { size: landscape; }
        }
    </style>
    <!-- Remove all JS that forcibly sets fill/stroke/color on sidebar SVGs -->
</head>
<body class="bg-gray-100 flex flex-col h-screen">
    <!-- Background Video -->
    <video autoplay muted loop id="backgroundVideo" class="prevent-select">
        <source src="https://cdn.pixabay.com/video/2023/02/16/150883-799711528_large.mp4" type="video/mp4">
    </video>

    <!-- Header -->
    <header class="flex items-center justify-between bg-white shadow-md px-6 py-4 fixed top-0 left-0 w-full z-50">
        <h1 class="text-xl font-bold text-gray-700">VolunteerHub</h1>
        <div class="relative flex items-center gap-4">
            <!-- Profile -->
            <img src="https://via.placeholder.com/40" alt="Profile" class="w-10 h-10 rounded-full border border-gray-300 cursor-pointer" onclick="toggleMenu()">
            <div id="profileMenu" class="hidden absolute top-16 right-0 w-44 shadow-lg rounded-md z-50 border transition-colors">
                <ul class="py-2 text-sm" id="profileMenuList">
                    <li><a href="#" class="block px-4 py-2">Profile</a></li>
                    <li><button class="w-full text-left block px-4 py-2 text-red-600">Log Out</button></li>
                </ul>
            </div>
        </div>
    </header>

    <!-- Layout Wrapper -->
    <div class="flex flex-1">
        <!-- Sidebar -->
        <aside class="w-64 h-[100vh] bg-gray-200 dark:bg-gray-800 text-gray-700 dark:text-gray-200 shadow-md flex flex-col justify-between fixed pt-24">
            <nav class="mt-6 flex-1">
                <ul class="space-y-2">
                    <li><a href="#" class="block px-6 py-3 text-gray-700 hover:bg-gray-200">Activities</a></li>
                    <li><a href="#" class="block px-6 py-3 text-gray-700 hover:bg-gray-200">Leaderboard</a></li>
                    <li><a href="#" class="block px-6 py-3 text-gray-700 hover:bg-gray-200">My Hours</a></li>
                    <li><a href="community.html" class="block px-6 py-3 text-gray-700 hover:bg-gray-200">Community</a></li>
                </ul>
            </nav>

            <div class="flex items-center justify-center gap-4 mb-4 px-6">
                <button id="sidebarSettingsBtn" class="w-10 h-10" style="padding-bottom: 10px;">
                    <!-- Remade SVG: simple gear/settings icon, accessible, using currentColor -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" class="themed-icon" aria-hidden="true" focusable="false">
                        <circle cx="12" cy="12" r="3.2" fill="currentColor"/>
                        <path fill="none" stroke="currentColor" stroke-width="2" d="M12 2v2M12 20v2M4.93 4.93l1.41 1.41M17.66 17.66l1.41 1.41M2 12h2M20 12h2M4.93 19.07l1.41-1.41M17.66 6.34l1.41-1.41"/>
                    </svg>
                </button>
                <button id="sidebarPrintBtn" class="w-10 h-10" style="padding-bottom: 10px;" onclick="window.location.href='print.html'">
                    <!-- Remade SVG: simple print icon, accessible, using currentColor -->
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32" class="themed-icon" aria-hidden="true" focusable="false">
                        <rect x="6" y="9" width="12" height="7" rx="1.5" fill="none" stroke="currentColor" stroke-width="2"/>
                        <rect x="8" y="16" width="8" height="4" rx="1" fill="currentColor"/>
                        <rect x="6" y="3" width="12" height="4" rx="1" fill="currentColor"/>
                        <circle cx="17" cy="12.5" r="1" fill="currentColor"/>
                    </svg>
                </button>
            </div>
        </aside>
        

        <!-- Main Content with Movable Widgets -->
        <main class="flex-1 p-6 ml-64 relative mt-[64px]">
            <!-- Greeting Container -->
            <div id="greetingContainer" class="bg-black bg-opacity-50 text-white p-6 rounded-md shadow-md relative greeting-container">
                <button id="editButton" class="absolute top-4 right-4 p-2 rounded-full transition-colors" title="Edit Widgets" style="background: var(--accent, #2563eb);">
                  <svg id="editIcon" xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#e3e3e3"><path d="M200-120q-33 0-56.5-23.5T120-200v-560q0-33 23.5-56.5T200-840h357l-80 80H200v560h560v-278l80-80v358q0 33-23.5 56.5T760-120H200Zm280-360ZM360-360v-170l367-367q12-12 27-18t30-6q16 0 30.5 6t26.5 18l56 57q11 12 17 26.5t6 29.5q0 15-5.5 29.5T897-728L530-360H360Zm481-424-56-56 56 56ZM440-440h56l232-232-28-28-29-28-231 231v57Zm260-260-29-28 29 28 28 28-28-28Z"/></svg>
                </button>
                <h1 id="greeting" class="text-3xl font-bold"></h1>
                <p id="currentDate" class="text-lg mt-2"></p>
            </div>

            <!-- Movable Widgets -->
        <!-- Movable Container -->
        <div class="container" id="container">
            <!-- Movable Widgets -->
            <div class="widget bg-black bg-opacity-25 text-white flex flex-col items-center justify-center select-none" id="widget1" style="user-select: none;">
  <div class="corner-br"></div>
  <div class="text-lg font-semibold mb-1">Approved Hours</div>
  <div id="approvedHours" class="text-3xl font-bold">0</div>
  <div class="text-sm mt-1">Signed Activities</div>
  <div id="approvedActivities" class="text-xl font-semibold">0</div>
</div>
            <div class="widget bg-black bg-opacity-25 text-white flex flex-col items-center justify-center select-none" id="widget2" style="user-select: none;">
  <div class="corner-br"></div>
  <div class="text-lg font-semibold mb-1">Unapproved Hours</div>
  <div id="unapprovedHours" class="text-3xl font-bold">0</div>
  <div class="text-sm mt-1">Unapproved Activities</div>
  <div id="unapprovedActivities" class="text-xl font-semibold">0</div>
</div>
            <div class="widget bg-black bg-opacity-25 text-white" id="widget3">
  <div class="corner-br"></div>
  <div class="text-lg font-semibold mb-1">Hours Breakdown</div>
  <canvas id="hoursPieChart" width="180" height="180" style="margin:0 auto;display:block;"></canvas>
  <div class="flex items-center justify-center mt-2">
    <span style="display:inline-flex;align-items:center;margin-right:12px;">
      <span style="display:inline-block;width:12px;height:12px;border-radius:50%;background:#4ade80;margin-right:5px;"></span>
      <span style="font-size:12px;">Approved</span>
    </span>
    <span style="display:inline-flex;align-items:center;">
      <span style="display:inline-block;width:12px;height:12px;border-radius:50%;background:#f87171;margin-right:5px;"></span>
      <span style="font-size:12px;">Unapproved</span>
    </span>
  </div>
</div>
            <div class="widget bg-black bg-opacity-25 text-white" id="widget4">
  <div class="corner-br"></div>
  Widget 4
</div>
        </div>

        <!-- Activities Section -->
        <section id="activitiesSection" class="mt-12 bg-white bg-opacity-80 rounded-md shadow-md p-6">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-2xl font-bold text-gray-800">Activities</h2>
                <button id="addActivityBtn" class="px-4 py-2 bg-blue-600 text-white rounded-md">Add Activity</button>
            </div>
            <!-- Modal for Add Activity Form -->
            <div id="activityModal" class="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40 hidden">
        <div class="bg-white rounded-lg shadow-lg p-6 relative w-full max-w-lg">
            <button id="closeActivityModal" class="absolute top-2 right-2 text-gray-500 hover:text-gray-800 text-2xl font-bold">&times;</button>
            <form id="addActivityForm" class="space-y-4 mb-4">
                <div class="flex flex-wrap gap-4">
                    <input type="text" id="activityTitle" placeholder="Title" class="border rounded px-3 py-2 flex-1" required>
                    <input type="text" id="activityPlace" placeholder="Place" class="border rounded px-3 py-2 flex-1" required>
                </div>
                <div class="flex flex-wrap gap-4">
                    <input type="date" id="activityDate" class="border rounded px-3 py-2 flex-1" required>
                    <input type="time" id="activityStartTime" class="border rounded px-3 py-2 flex-1" required>
                    <input type="time" id="activityEndTime" class="border rounded px-3 py-2 flex-1" required>
                </div>
                <div class="flex flex-wrap gap-4">
                    <input type="text" id="supervisorName" placeholder="Supervisor Name" class="border rounded px-3 py-2 flex-1" required>
                    <input type="email" id="supervisorEmail" placeholder="Supervisor Email" class="border rounded px-3 py-2 flex-1" required>
                </div>
                <div class="flex items-center mb-2">
                    <input type="checkbox" id="getSignatureCheckbox" class="mr-2">
                    <label for="getSignatureCheckbox" class="text-gray-700">Get a Signature (email supervisor)</label>
                </div>
                <div class="flex gap-4">
                    <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded">Submit</button>
                    <button type="button" id="cancelAddActivity" class="px-4 py-2 bg-gray-400 text-white rounded">Cancel</button>
                </div>
            </form>
        </div>
    </div>
    <div id="activityStatus" class="mb-4"></div>
    <div id="activitiesList"></div>
    <button id="printActivitiesBtn" style="margin:20px 0; display:none;" class="px-4 py-2 bg-purple-600 text-white rounded-md">Print Activities PDF</button>
</section>
<!-- End Activities Section -->

        <!-- Leaderboard Section -->
        <section id="leaderboardSection" class="mt-12 bg-white bg-opacity-80 rounded-md shadow-md p-6">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-2xl font-bold text-gray-800">Leaderboard</h2>
                <div class="flex gap-2">
                    <button id="globalLeaderboardBtn" class="px-3 py-1 bg-blue-600 text-white rounded-md">Global</button>
                    <button id="friendsLeaderboardBtn" class="px-3 py-1 bg-gray-400 text-white rounded-md">Friends</button>
                    <button id="localLeaderboardBtn" class="px-3 py-1 bg-gray-400 text-white rounded-md">Local</button>
                </div>
            </div>
            <div id="leaderboardStatus" class="mb-4"></div>
            <div class="overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead>
                        <tr>
                            <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Rank</th>
                            <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Volunteer</th>
                            <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Approved Hours</th>
                            <th class="px-6 py-3 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Unapproved Hours</th>
                        </tr>
                    </thead>
                    <tbody id="leaderboardBody" class="bg-white divide-y divide-gray-200">
                        <tr><td colspan="4" class="text-center text-gray-400 py-4">Loading...</td></tr>
                    </tbody>
                </table>
            </div>
        </section>
        <!-- End Leaderboard Section -->
        </main>
    </div>

    <script src="dashboard-core.js"></script>
    <script src="dashboard-theme.js"></script>
    <script src="dashboard-activities.js"></script>
    <script src="dashboard-leaderboard.js"></script>
    <script src="dashboard-ui.js"></script>
    <script type="module" src="app.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script>
// Remove all JS that forcibly sets fill/stroke/color on sidebar SVGs
// Fix: Remove applyThemedIcons and all direct fill/color setting for .themed-icon SVGs
// Sidebar SVGs should only use CSS for color, and SVGs must use fill="currentColor"
    </script>
</body>
</html>
